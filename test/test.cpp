#include <cstddef>
#include <map>

#include "../verifiers.h"
#include "gtest/gtest.h"

// These tests excercise the verifiers. It's tricky to test them, since
// correctness means "it does what it is written on the card. One approach is
// to stare at the code and stare at the card and convince oneself they are
// equivalent. But that's tedious and probably error prone.

// So I created a bunch of tabled with inputs and expected outputs.
// That was tedious as well. I think the main benefit is that expressing the
// rules twice and debugging them helps illuminate errors.

// To simplify that tables, I divided the cards into two classes.
// It is simpler to test cards where for any code, exactly one
// criterion holds.

// Card numbers that can use the simple test.
bool IsSimple(std::size_t card) {
  return 1 <= card && card <= 13 || 16 <= card && card <= 25;
}

// Test the "exactly one" property for simple cards.
TEST(Verifiers, ExactlyOne) {
  for (std::size_t card = 1; card <= 48; ++card) {
    if (!IsSimple(card)) {
      continue;
    }
    const Verifier& v = verifiers[card - 1];
    bool all_good = true;
    for (int i = 1; i <= 5; ++i) {
      for (int j = 1; j <= 5; ++j) {
        for (int k = 1; k <= 5; ++k) {
          std::size_t success = 0;
          for (Criterion c : v) {
            if (c(i, j, k)) {
              success += 1;
            }
          }
          if (success != 1) {
            all_good = false;
          }
        }
      }
    }
    if (!all_good) {
      ADD_FAILURE() << "Card " << card << " is bad";
    }
  }
}

// The data table for testing the simple card.
// For each criterion, we simply list some codes that satisify it.
const std::map<int, std::vector<std::vector<Triple>>> exactly_one_data = {
    {1,
     {
         {{1, 1, 1}, {1, 4, 2}, {1, 5, 2}, {1, 5, 4}, {1, 3, 3}},
         {{2, 5, 2}, {4, 2, 3}, {4, 1, 2}, {2, 1, 1}, {5, 1, 2}},
     }},

    {2,
     {
         {{2, 1, 5}, {2, 1, 4}, {2, 3, 2}, {2, 1, 2}, {1, 3, 5}},
         {{3, 3, 1}, {3, 2, 1}, {3, 1, 2}, {3, 2, 4}, {3, 1, 5}},
         {{4, 3, 4}, {4, 2, 4}, {5, 5, 3}, {4, 3, 2}, {5, 3, 1}},
     }},

    {3,
     {
         {{4, 1, 2}, {4, 2, 2}, {3, 1, 5}, {3, 2, 5}, {5, 2, 1}},
         {{3, 3, 5}, {2, 3, 4}, {2, 3, 3}, {1, 3, 1}, {1, 3, 4}},
         {{1, 4, 4}, {2, 4, 5}, {3, 4, 3}, {5, 5, 4}, {4, 4, 5}},
     }},

    {4,
     {
         {{5, 2, 3}, {2, 3, 5}, {2, 1, 3}, {3, 3, 2}, {5, 3, 5}},
         {{2, 4, 2}, {5, 4, 3}, {4, 4, 2}, {1, 4, 3}, {2, 4, 5}},
         {{5, 5, 5}, {2, 5, 4}, {4, 5, 4}, {2, 5, 3}, {2, 5, 1}},
     }},

    {5,
     {
         {{2, 1, 1}, {4, 5, 5}, {2, 1, 3}, {4, 4, 1}, {4, 4, 2}},
         {{1, 2, 4}, {1, 2, 1}, {5, 2, 3}, {3, 4, 5}, {1, 1, 2}},
     }},

    {6,
     {
         {{3, 2, 1}, {2, 4, 5}, {3, 4, 5}, {5, 4, 4}, {3, 4, 3}},
         {{2, 3, 3}, {1, 1, 1}, {1, 3, 3}, {3, 3, 2}, {3, 5, 2}},
     }},

    {7,
     {
         {{2, 3, 2}, {3, 1, 2}, {5, 5, 2}, {5, 3, 2}, {3, 1, 4}},
         {{3, 3, 5}, {2, 2, 1}, {4, 5, 5}, {3, 1, 1}, {2, 3, 1}},
     }},

    {8,
     {
         {{5, 5, 2}, {5, 3, 2}, {4, 3, 4}, {3, 3, 5}, {2, 3, 2}},
         {{4, 3, 1}, {1, 3, 2}, {3, 1, 5}, {1, 5, 5}, {1, 5, 3}},
         {{1, 1, 2}, {1, 1, 5}, {1, 5, 1}, {4, 1, 1}, {3, 1, 1}},
         {{1, 1, 1}},
     }},

    {9,
     {
         {{5, 4, 4}, {4, 5, 4}, {4, 5, 2}, {4, 1, 2}, {2, 1, 5}},
         {{3, 4, 4}, {5, 3, 5}, {2, 2, 3}, {2, 3, 2}, {3, 2, 4}},
         {{3, 4, 3}, {1, 3, 3}, {3, 3, 2}, {5, 3, 3}, {4, 3, 3}},
         {{3, 3, 3}},
     }},

    {10,
     {
         {{1, 3, 2}, {5, 1, 3}, {2, 2, 2}, {2, 1, 5}, {2, 3, 1}},
         {{4, 3, 5}, {4, 3, 3}, {4, 2, 2}, {2, 5, 4}, {3, 4, 2}},
         {{1, 4, 4}, {4, 4, 5}, {4, 3, 4}, {2, 4, 4}, {4, 1, 4}},
         {{4, 4, 4}},
     }},

    {11,
     {
         {{2, 3, 4}, {2, 4, 4}, {2, 4, 2}, {1, 3, 4}, {1, 4, 3}},
         {{2, 2, 2}, {3, 3, 4}, {2, 2, 3}, {1, 1, 5}, {4, 4, 5}},
         {{3, 1, 5}, {5, 1, 4}, {5, 3, 3}, {4, 3, 1}, {2, 1, 3}},
     }},

    {12,
     {
         {{3, 1, 4}, {1, 4, 2}, {1, 1, 5}, {1, 5, 4}, {3, 4, 4}},
         {{5, 2, 5}, {1, 2, 1}, {2, 2, 2}, {1, 5, 1}, {4, 3, 4}},
         {{5, 5, 4}, {4, 4, 1}, {3, 1, 1}, {2, 5, 1}, {5, 1, 2}},
     }},

    {13,
     {
         {{5, 4, 5}, {1, 1, 4}, {3, 2, 5}, {4, 4, 5}, {5, 2, 4}},
         {{5, 5, 5}, {4, 5, 5}, {5, 2, 2}, {4, 1, 1}, {1, 1, 1}},
         {{1, 5, 4}, {1, 4, 3}, {2, 5, 3}, {2, 4, 3}, {5, 4, 1}},
     }},

    {16,
     {
         {{2, 3, 4}, {2, 1, 4}, {4, 2, 2}, {2, 4, 5}, {5, 2, 2}},
         {{5, 5, 4}, {3, 4, 1}, {3, 1, 2}, {4, 3, 5}, {3, 3, 3}},
     }},

    {17,
     {
         {{1, 3, 1}, {1, 3, 5}, {5, 1, 3}, {1, 1, 5}, {3, 1, 3}},
         {{5, 1, 4}, {1, 5, 4}, {2, 3, 3}, {1, 4, 5}, {4, 3, 5}},
         {{3, 4, 4}, {2, 3, 4}, {1, 2, 4}, {5, 2, 2}, {4, 2, 1}},
         {{2, 4, 4}, {4, 2, 2}, {2, 4, 2}, {2, 2, 4}, {4, 2, 4}},
     }},

    {18,
     {
         {{1, 5, 4}, {4, 1, 1}, {1, 2, 1}, {4, 3, 1}, {5, 3, 4}},
         {{2, 3, 2}, {4, 4, 3}, {3, 3, 5}, {4, 2, 1}, {4, 2, 5}},
     }},

    {19,
     {
         {{2, 2, 5}, {2, 1, 5}, {1, 1, 1}, {3, 2, 1}, {4, 1, 2}},
         {{2, 4, 2}, {4, 2, 5}, {3, 3, 1}, {5, 1, 3}, {2, 4, 1}},
         {{3, 4, 5}, {3, 4, 3}, {4, 4, 3}, {3, 5, 5}, {4, 5, 1}},
     }},

    {20,
     {
         {{1, 1, 1}, {2, 2, 2}, {3, 3, 3}, {4, 4, 4}, {5, 5, 5}},
         {{1, 4, 4}, {5, 1, 1}, {5, 5, 4}, {4, 3, 4}, {2, 4, 2}},
         {{5, 2, 4}, {4, 1, 5}, {2, 4, 1}, {4, 1, 3}, {2, 3, 4}},
     }},

    {21,
     {
         {{1, 4, 2}, {2, 4, 5}, {5, 1, 3}, {4, 2, 5}, {1, 4, 5}},
         {{1, 2, 1}, {2, 4, 2}, {5, 4, 5}, {3, 3, 2}, {1, 5, 5}},
     }},

    {22,
     {
         {{2, 3, 5}, {1, 3, 4}, {1, 3, 5}, {1, 2, 5}, {1, 4, 5}},
         {{5, 4, 2}, {4, 3, 2}, {4, 2, 1}, {5, 3, 1}, {3, 2, 1}},
         {{5, 1, 3}, {4, 3, 3}, {5, 2, 3}, {5, 5, 1}, {1, 2, 1}},
     }},

    {23,
     {
         {{1, 1, 3}, {1, 2, 1}, {3, 1, 1}, {1, 1, 1}, {1, 1, 2}},
         {{1, 3, 2}, {2, 1, 3}, {2, 2, 2}, {1, 2, 3}, {1, 4, 1}},
         {{3, 2, 4}, {3, 3, 1}, {2, 3, 5}, {3, 5, 1}, {4, 1, 5}},
     }},

    {24,
     {
         {{3, 4, 5}, {2, 3, 4}, {1, 2, 3}},
         {{3, 4, 3}, {1, 4, 5}, {2, 2, 3}, {3, 1, 2}, {4, 5, 1}},
         {{1, 3, 5}, {2, 2, 1}, {1, 3, 2}, {4, 4, 2}, {4, 4, 4}},
     }},

    {25,
     {
         {{2, 4, 2}, {3, 1, 3}, {1, 3, 5}, {1, 3, 3}, {5, 3, 1}},
         {{3, 4, 3}, {4, 3, 4}, {1, 2, 5}, {5, 3, 2}, {2, 3, 5}},
         {{3, 2, 1}, {2, 3, 4}, {5, 4, 3}, {4, 3, 2}, {1, 2, 3}},
     }}};

// Check that the data table above matches what the verifiers actually do.
TEST(Verifiers, ExactlyOneData) {
  for (std::size_t card = 1; card <= 48; ++card) {
    if (!IsSimple(card)) {
      continue;
    }
    const Verifier& v = verifiers[card - 1];
    const auto iter = exactly_one_data.find(card);
    if (iter == exactly_one_data.end()) {
      ADD_FAILURE() << "Missing data for card " << card;
    } else {
      // Golden points to a vector of codes that should satisfy
      // the verifier.
      const auto& golden = iter->second;
      ASSERT_EQ(golden.size(), v.size());
      for (size_t i = 0; i < golden.size(); ++i) {
        for (const Triple t : golden[i]) {
          EXPECT_TRUE(v[i](t[0], t[1], t[2]))
              << "Card " << card << ", part " << i;
        }
      }
    }
  }
}

// For the non-simple cards, for each criterion on the card, we need
// a list of codes that satisfy the criteron and a list that  do not.
// The middle vector is always length 2. It could be a std::array,
// but then we need weird rules for placing brackets.
const std::map<int, std::vector<std::vector<std::vector<Triple>>>> other_data =
    {{14,
      {
          {{
               {2, 4, 3},
               {2, 4, 5},
               {2, 5, 4},
               {1, 4, 2},
               {4, 5, 5},
           },
           {
               {4, 4, 3},
               {3, 4, 1},
               {5, 4, 3},
               {5, 5, 5},
               {3, 1, 4},
           }},
          {{
               {3, 1, 4},
               {5, 1, 3},
               {5, 2, 4},
               {4, 3, 5},
               {5, 4, 5},
           },
           {
               {4, 4, 3},
               {3, 4, 1},
               {5, 4, 3},
               {2, 4, 3},
               {5, 5, 5},
           }},
          {{
               {4, 4, 3},
               {3, 4, 1},
               {5, 4, 3},
               {5, 5, 4},
               {4, 3, 2},
           },
           {
               {2, 4, 3},
               {5, 5, 5},
               {3, 1, 4},
               {5, 1, 3},
               {2, 4, 5},
           }},
      }},

     {15,
      {
          {{
               {4, 2, 3},
               {4, 1, 2},
               {2, 1, 1},
               {5, 1, 2},
               {5, 4, 3},
           },
           {
               {2, 5, 2},
               {1, 4, 3},
               {1, 5, 4},
               {4, 2, 4},
               {5, 2, 5},
           }},
          {{
               {2, 5, 2},
               {1, 4, 3},
               {1, 5, 4},
               {2, 4, 2},
               {1, 5, 1},
           },
           {
               {4, 2, 3},
               {4, 1, 2},
               {2, 1, 1},
               {5, 3, 2},
               {4, 2, 2},
           }},
          {{
               {1, 3, 4},
               {2, 1, 5},
               {1, 2, 4},
               {3, 3, 4},
               {2, 1, 4},
           },
           {
               {2, 5, 2},
               {3, 2, 3},
               {4, 1, 2},
               {2, 1, 1},
               {1, 4, 2},
           }},
      }},

     {26,
      {
          {{
               {2, 1, 5},
               {2, 1, 4},
               {2, 3, 2},
               {2, 1, 2},
               {1, 3, 5},
           },
           {
               {3, 2, 3},
               {4, 5, 5},
               {5, 2, 5},
               {4, 3, 2},
               {4, 4, 2},
           }},
          {{
               {3, 2, 3},
               {2, 1, 5},
               {2, 1, 4},
               {5, 2, 5},
               {2, 1, 2},
           },
           {
               {4, 5, 5},
               {4, 3, 2},
               {4, 4, 2},
               {2, 3, 2},
               {5, 5, 5},
           }},
          {{
               {4, 3, 2},
               {4, 4, 2},
               {2, 3, 2},
               {2, 1, 2},
               {1, 1, 1},
           },
           {
               {3, 2, 3},
               {2, 1, 5},
               {2, 1, 4},
               {4, 5, 5},
               {5, 2, 5},
           }},
      }},

     {27,
      {
          {{
               {3, 3, 1},
               {1, 1, 5},
               {3, 2, 1},
               {2, 2, 4},
               {1, 3, 2},
           },
           {
               {5, 2, 1},
               {5, 1, 1},
               {5, 2, 5},
               {4, 4, 3},
               {5, 4, 4},
           }},
          {{
               {5, 2, 1},
               {3, 3, 1},
               {1, 1, 5},
               {3, 2, 1},
               {5, 1, 1},
           },
           {
               {4, 4, 3},
               {5, 4, 4},
               {1, 4, 1},
               {2, 5, 2},
               {1, 5, 5},
           }},
          {{
               {5, 2, 1},
               {3, 3, 2},
               {3, 2, 1},
               {5, 1, 1},
               {4, 4, 3},
           },
           {
               {1, 1, 5},
               {5, 2, 5},
               {2, 2, 4},
               {5, 4, 4},
               {3, 2, 4},
           }},
      }},

     {28,
      {
          {{
               {1, 1, 1},
               {1, 2, 1},
               {1, 1, 2},
               {1, 5, 3},
               {1, 4, 4},
           },
           {
               {4, 3, 4},
               {3, 2, 5},
               {3, 3, 4},
               {3, 4, 1},
               {2, 4, 1},
           }},
          {{
               {3, 1, 2},
               {1, 1, 1},
               {3, 1, 4},
               {1, 1, 2},
               {5, 1, 2},
           },
           {
               {4, 3, 4},
               {3, 2, 5},
               {3, 3, 4},
               {3, 4, 1},
               {2, 4, 1},
           }},
          {{
               {3, 4, 1},
               {2, 4, 1},
               {1, 1, 1},
               {1, 2, 1},
               {3, 3, 1},
           },
           {
               {4, 3, 4},
               {3, 2, 5},
               {3, 3, 4},
               {3, 5, 2},
               {3, 1, 2},
           }},
      }},

     {29,
      {
          {{
               {3, 1, 5},
               {3, 2, 5},
               {3, 3, 5},
               {3, 5, 2},
               {3, 1, 2},
           },
           {
               {2, 3, 1},
               {4, 1, 2},
               {2, 4, 1},
               {4, 2, 2},
               {2, 5, 4},
           }},
          {{
               {2, 3, 1},
               {3, 3, 5},
               {5, 3, 5},
               {2, 3, 5},
               {4, 3, 1},
           },
           {
               {4, 1, 2},
               {2, 4, 1},
               {4, 2, 2},
               {3, 5, 5},
               {3, 2, 5},
           }},
          {{
               {5, 1, 3},
               {4, 2, 3},
               {1, 1, 3},
               {3, 5, 3},
               {5, 3, 3},
           },
           {
               {2, 3, 1},
               {4, 1, 2},
               {2, 4, 4},
               {4, 2, 2},
               {3, 1, 5},
           }},
      }},

     {30,
      {
          {{
               {4, 1, 5},
               {4, 5, 4},
               {4, 4, 4},
               {4, 5, 3},
               {4, 1, 2},
           },
           {
               {1, 2, 2},
               {2, 1, 1},
               {3, 1, 5},
               {3, 5, 3},
               {5, 5, 4},
           }},
          {{
               {4, 4, 4},
               {2, 4, 2},
               {5, 4, 3},
               {1, 4, 1},
               {4, 4, 2},
           },
           {
               {5, 2, 2},
               {5, 3, 1},
               {3, 1, 5},
               {3, 5, 3},
               {4, 1, 5},
           }},
          {{
               {5, 5, 4},
               {5, 1, 4},
               {4, 5, 4},
               {4, 4, 4},
               {2, 2, 4},
           },
           {
               {5, 2, 2},
               {5, 1, 1},
               {3, 1, 5},
               {3, 5, 3},
               {4, 1, 5},
           }},
      }},

     {31,
      {
          {{
               {3, 1, 2},
               {5, 1, 5},
               {3, 3, 1},
               {4, 1, 5},
               {2, 4, 5},
           },
           {
               {1, 2, 3},
               {1, 4, 4},
               {1, 5, 4},
               {1, 4, 3},
               {1, 1, 2},
           }},
          {{
               {1, 2, 3},
               {1, 4, 4},
               {3, 3, 1},
               {2, 5, 5},
               {3, 4, 3},
           },
           {
               {3, 1, 2},
               {5, 1, 5},
               {2, 1, 5},
               {4, 1, 3},
               {2, 1, 1},
           }},
          {{
               {1, 2, 3},
               {3, 1, 2},
               {5, 1, 5},
               {1, 4, 4},
               {2, 1, 5},
           },
           {
               {3, 3, 1},
               {2, 1, 1},
               {3, 2, 1},
               {4, 2, 1},
               {3, 5, 1},
           }},
      }},

     {32,
      {
          {{
               {5, 2, 3},
               {5, 3, 5},
               {4, 5, 2},
               {4, 1, 5},
               {4, 4, 2},
           },
           {
               {1, 5, 1},
               {2, 3, 5},
               {2, 4, 4},
               {2, 1, 3},
               {3, 3, 2},
           }},
          {{
               {2, 5, 1},
               {2, 4, 4},
               {3, 4, 2},
               {3, 5, 4},
               {4, 5, 2},
           },
           {
               {5, 2, 3},
               {2, 3, 5},
               {2, 1, 3},
               {3, 3, 2},
               {5, 3, 5},
           }},
          {{
               {2, 3, 5},
               {2, 4, 4},
               {5, 3, 5},
               {3, 5, 4},
               {1, 3, 4},
           },
           {
               {5, 2, 3},
               {2, 5, 1},
               {2, 1, 3},
               {3, 3, 2},
               {3, 4, 2},
           }},
      }},

     {33,
      {
          {{
               {2, 1, 5},
               {4, 2, 4},
               {2, 2, 3},
               {2, 2, 4},
               {2, 5, 2},
           },
           {
               {5, 5, 2},
               {5, 1, 4},
               {1, 5, 4},
               {5, 4, 3},
               {1, 2, 2},
           }},
          {{
               {4, 2, 4},
               {2, 2, 3},
               {2, 2, 4},
               {2, 2, 5},
               {2, 4, 2},
           },
           {
               {2, 1, 5},
               {2, 5, 2},
               {5, 3, 2},
               {5, 1, 4},
               {1, 5, 4},
           }},
          {{
               {4, 2, 4},
               {2, 2, 4},
               {2, 5, 2},
               {5, 5, 2},
               {5, 1, 4},
           },
           {
               {2, 1, 1},
               {2, 2, 3},
               {2, 2, 5},
               {2, 3, 5},
               {5, 4, 3},
           }},
          {{
               {5, 5, 2},
               {5, 1, 4},
               {3, 5, 4},
               {5, 4, 3},
               {1, 2, 2},
           },
           {
               {2, 1, 5},
               {4, 2, 4},
               {2, 2, 3},
               {2, 2, 4},
               {2, 5, 2},
           }},
          {{
               {2, 1, 5},
               {2, 5, 2},
               {5, 3, 2},
               {5, 1, 4},
               {1, 5, 4},
           },
           {
               {4, 2, 4},
               {2, 2, 3},
               {2, 2, 4},
               {2, 2, 5},
               {2, 4, 2},
           }},
          {{
               {2, 1, 5},
               {2, 2, 3},
               {2, 2, 5},
               {2, 3, 5},
               {5, 4, 1},
           },
           {
               {4, 2, 4},
               {2, 2, 4},
               {2, 5, 2},
               {5, 5, 2},
               {5, 1, 4},
           }},
      }},

     {34,
      {
          {{
               {1, 1, 3},
               {2, 2, 4},
               {5, 5, 5},
               {2, 5, 4},
               {2, 4, 3},
           },
           {
               {5, 4, 1},
               {3, 2, 5},
               {3, 1, 2},
               {4, 4, 1},
               {5, 2, 3},
           }},
          {{
               {1, 1, 3},
               {2, 2, 4},
               {3, 2, 5},
               {5, 5, 5},
               {3, 1, 2},
           },
           {
               {5, 4, 1},
               {2, 5, 4},
               {4, 4, 1},
               {2, 4, 3},
               {1, 3, 1},
           }},
          {{
               {5, 4, 1},
               {5, 5, 5},
               {4, 4, 1},
               {1, 3, 1},
               {4, 5, 4},
           },
           {
               {1, 1, 3},
               {2, 2, 4},
               {3, 2, 3},
               {2, 5, 4},
               {3, 1, 2},
           }},
      }},

     {35,
      {
          {{
               {5, 4, 2},
               {1, 1, 1},
               {2, 1, 1},
               {5, 5, 5},
               {3, 3, 2},
           },
           {
               {4, 5, 5},
               {2, 1, 3},
               {3, 4, 1},
               {2, 3, 3},
               {3, 3, 5},
           }},
          {{
               {1, 1, 1},
               {4, 5, 5},
               {5, 5, 5},
               {3, 3, 1},
               {4, 4, 1},
           },
           {
               {5, 4, 2},
               {2, 1, 1},
               {5, 2, 5},
               {2, 1, 3},
               {1, 3, 4},
           }},
          {{
               {1, 1, 1},
               {4, 5, 5},
               {5, 5, 5},
               {1, 2, 4},
               {2, 1, 3},
           },
           {
               {5, 4, 2},
               {2, 1, 1},
               {3, 1, 2},
               {4, 4, 1},
               {3, 4, 3},
           }},
      }},

     {36,
      {
          {{
               {3, 4, 5},
               {1, 4, 1},
               {3, 3, 3},
               {2, 2, 2},
               {5, 2, 2},
           },
           {
               {2, 2, 4},
               {2, 4, 1},
               {1, 2, 1},
               {5, 3, 2},
               {4, 3, 1},
           }},
          {{
               {1, 2, 1},
               {4, 3, 1},
               {3, 4, 5},
               {1, 1, 2},
               {2, 1, 5},
           },
           {
               {1, 1, 1},
               {2, 4, 1},
               {4, 5, 4},
               {1, 1, 3},
               {1, 4, 1},
           }},
          {{
               {5, 2, 3},
               {1, 3, 1},
               {4, 3, 3},
               {1, 2, 2},
               {3, 1, 1},
           },
           {
               {1, 1, 1},
               {2, 3, 1},
               {1, 2, 1},
               {4, 4, 4},
               {4, 3, 1},
           }},
      }},

     {37,
      {
          {{
               {1, 3, 2},
               {3, 1, 1},
               {2, 2, 3},
               {3, 1, 2},
               {3, 1, 4},
           },
           {
               {4, 1, 3},
               {1, 5, 1},
               {1, 5, 3},
               {1, 1, 5},
               {3, 2, 1},
           }},
          {{
               {3, 2, 1},
               {1, 1, 3},
               {2, 1, 2},
               {2, 5, 2},
               {1, 2, 3},
           },
           {
               {4, 5, 3},
               {1, 3, 1},
               {1, 5, 2},
               {1, 3, 5},
               {5, 5, 3},
           }},
          {{
               {1, 1, 3},
               {5, 3, 1},
               {2, 1, 3},
               {5, 1, 3},
               {4, 3, 1},
           },
           {
               {4, 1, 4},
               {1, 5, 1},
               {1, 5, 2},
               {1, 1, 5},
               {3, 1, 1},
           }},
      }},

     {38,
      {
          {{
               {2, 4, 4},
               {3, 3, 2},
               {2, 4, 1},
               {1, 5, 5},
               {5, 1, 3},
           },
           {
               {2, 3, 3},
               {5, 4, 2},
               {1, 4, 1},
               {1, 1, 5},
               {1, 3, 3},
           }},
          {{
               {2, 4, 4},
               {1, 5, 5},
               {3, 2, 3},
               {3, 5, 3},
               {2, 1, 4},
           },
           {
               {2, 3, 3},
               {5, 4, 2},
               {1, 4, 1},
               {5, 1, 2},
               {1, 3, 3},
           }},
          {{
               {2, 3, 3},
               {5, 4, 2},
               {1, 3, 3},
               {1, 5, 1},
               {1, 4, 2},
           },
           {
               {2, 4, 1},
               {2, 4, 4},
               {1, 1, 1},
               {4, 3, 2},
               {5, 4, 5},
           }},
      }},

     {39,
      {
          {{
               {1, 3, 5},
               {1, 1, 3},
               {1, 2, 1},
               {1, 5, 3},
               {1, 3, 2},
           },
           {
               {4, 1, 5},
               {4, 5, 3},
               {5, 3, 1},
               {2, 3, 2},
               {3, 3, 3},
           }},
          {{
               {4, 1, 5},
               {1, 1, 3},
               {3, 1, 2},
               {2, 1, 5},
               {3, 1, 4},
           },
           {
               {4, 5, 3},
               {1, 3, 5},
               {5, 2, 1},
               {2, 4, 2},
               {3, 3, 3},
           }},
          {{
               {5, 3, 1},
               {4, 3, 1},
               {1, 2, 1},
               {5, 1, 1},
               {3, 1, 1},
           },
           {
               {4, 1, 5},
               {4, 5, 3},
               {1, 3, 5},
               {2, 3, 2},
               {3, 3, 3},
           }},
          {{
               {4, 1, 5},
               {4, 5, 3},
               {5, 3, 1},
               {2, 3, 2},
               {3, 3, 3},
           },
           {
               {1, 3, 5},
               {1, 1, 3},
               {1, 2, 1},
               {1, 5, 3},
               {1, 3, 2},
           }},
          {{
               {4, 5, 3},
               {1, 4, 5},
               {5, 3, 1},
               {2, 2, 2},
               {3, 3, 3},
           },
           {
               {4, 1, 5},
               {1, 1, 3},
               {3, 1, 2},
               {2, 1, 5},
               {3, 1, 4},
           }},
          {{
               {4, 1, 5},
               {4, 5, 3},
               {1, 3, 4},
               {2, 3, 2},
               {3, 3, 3},
           },
           {
               {5, 3, 1},
               {4, 3, 1},
               {1, 2, 1},
               {5, 1, 1},
               {3, 1, 1},
           }},
      }},

     {40,
      {
          {{
               {2, 2, 1},
               {2, 3, 1},
               {2, 5, 1},
               {1, 2, 1},
               {1, 3, 4},
           },
           {
               {3, 3, 4},
               {5, 2, 4},
               {3, 3, 5},
               {4, 1, 4},
               {4, 4, 2},
           }},
          {{
               {5, 2, 4},
               {4, 1, 4},
               {3, 2, 4},
               {2, 2, 1},
               {3, 1, 1},
           },
           {
               {3, 3, 4},
               {3, 3, 5},
               {4, 4, 2},
               {4, 5, 5},
               {2, 3, 1},
           }},
          {{
               {4, 4, 2},
               {2, 2, 1},
               {3, 1, 1},
               {2, 3, 2},
               {2, 5, 1},
           },
           {
               {3, 3, 3},
               {5, 2, 4},
               {3, 3, 5},
               {4, 1, 4},
               {3, 2, 4},
           }},
          {{
               {3, 3, 4},
               {3, 3, 5},
               {3, 2, 4},
               {3, 1, 1},
               {3, 5, 5},
           },
           {
               {5, 2, 4},
               {1, 1, 4},
               {4, 4, 2},
               {2, 2, 1},
               {4, 5, 5},
           }},
          {{
               {3, 3, 4},
               {3, 3, 5},
               {2, 3, 1},
               {5, 3, 3},
               {4, 3, 4},
           },
           {
               {5, 2, 4},
               {4, 1, 4},
               {4, 4, 2},
               {3, 2, 4},
               {2, 5, 1},
           }},
          {{
               {3, 1, 3},
               {3, 2, 3},
               {5, 3, 3},
               {4, 2, 3},
               {2, 5, 3},
           },
           {
               {3, 3, 1},
               {5, 2, 4},
               {3, 3, 5},
               {4, 1, 4},
               {4, 4, 2},
           }},
          {{
               {5, 2, 4},
               {4, 1, 4},
               {4, 4, 2},
               {4, 5, 5},
               {5, 5, 2},
           },
           {
               {3, 3, 4},
               {3, 3, 5},
               {1, 2, 4},
               {2, 2, 1},
               {3, 1, 1},
           }},
          {{
               {4, 4, 2},
               {4, 5, 5},
               {3, 5, 5},
               {2, 4, 1},
               {5, 5, 2},
           },
           {
               {3, 3, 4},
               {5, 2, 4},
               {3, 3, 5},
               {4, 1, 4},
               {3, 2, 4},
           }},
          {{
               {3, 3, 4},
               {5, 2, 4},
               {3, 3, 5},
               {4, 1, 4},
               {3, 2, 4},
           },
           {
               {4, 4, 2},
               {2, 2, 1},
               {3, 1, 3},
               {2, 3, 1},
               {2, 5, 1},
           }},
      }},

     {41,
      {
          {{
               {3, 3, 5},
               {1, 1, 5},
               {2, 3, 2},
               {2, 2, 5},
               {1, 5, 1},
           },
           {
               {5, 5, 2},
               {5, 3, 2},
               {4, 3, 4},
               {4, 1, 1},
               {5, 1, 5},
           }},
          {{
               {5, 3, 2},
               {4, 3, 4},
               {3, 3, 5},
               {1, 1, 5},
               {2, 3, 2},
           },
           {
               {5, 5, 2},
               {1, 5, 1},
               {2, 5, 3},
               {4, 4, 4},
               {2, 4, 2},
           }},
          {{
               {5, 5, 2},
               {5, 3, 2},
               {2, 3, 2},
               {4, 1, 1},
               {1, 5, 1},
           },
           {
               {4, 3, 4},
               {3, 3, 5},
               {1, 1, 5},
               {2, 2, 5},
               {5, 1, 5},
           }},
          {{
               {4, 3, 4},
               {4, 1, 1},
               {4, 4, 4},
               {4, 3, 2},
               {4, 5, 4},
           },
           {
               {5, 5, 2},
               {5, 3, 2},
               {3, 3, 5},
               {1, 1, 5},
               {2, 3, 2},
           }},
          {{
               {4, 4, 4},
               {2, 4, 2},
               {5, 4, 4},
               {5, 4, 2},
               {2, 4, 4},
           },
           {
               {5, 5, 2},
               {5, 2, 2},
               {4, 3, 4},
               {3, 3, 5},
               {1, 1, 5},
           }},
          {{
               {4, 3, 4},
               {4, 4, 4},
               {2, 3, 4},
               {5, 4, 4},
               {4, 5, 4},
           },
           {
               {5, 5, 1},
               {5, 3, 3},
               {3, 3, 5},
               {1, 1, 5},
               {2, 3, 2},
           }},
          {{
               {5, 5, 2},
               {5, 3, 2},
               {5, 1, 5},
               {5, 3, 1},
               {5, 4, 4},
           },
           {
               {4, 3, 4},
               {3, 3, 5},
               {1, 1, 5},
               {2, 3, 2},
               {2, 2, 5},
           }},
          {{
               {5, 5, 2},
               {1, 5, 1},
               {2, 5, 3},
               {1, 5, 5},
               {2, 5, 1},
           },
           {
               {5, 3, 2},
               {4, 2, 4},
               {3, 4, 5},
               {1, 1, 5},
               {2, 3, 2},
           }},
          {{
               {3, 3, 5},
               {1, 1, 5},
               {2, 2, 5},
               {5, 1, 5},
               {1, 5, 5},
           },
           {
               {5, 5, 2},
               {5, 3, 3},
               {4, 3, 4},
               {2, 3, 2},
               {4, 1, 1},
           }},
      }},

     {42,
      {
          {{
               {1, 3, 2},
               {1, 5, 5},
               {2, 5, 3},
               {3, 5, 5},
               {2, 3, 4},
           },
           {
               {3, 3, 2},
               {1, 1, 5},
               {4, 3, 1},
               {1, 5, 1},
               {3, 2, 5},
           }},
          {{
               {3, 1, 5},
               {3, 2, 5},
               {2, 1, 2},
               {4, 2, 3},
               {4, 1, 5},
           },
           {
               {3, 3, 2},
               {1, 1, 5},
               {4, 3, 1},
               {1, 5, 1},
               {3, 3, 2},
           }},
          {{
               {3, 3, 2},
               {4, 3, 1},
               {5, 3, 2},
               {4, 5, 3},
               {5, 3, 2},
           },
           {
               {1, 1, 2},
               {1, 5, 1},
               {1, 3, 2},
               {3, 2, 4},
               {1, 5, 5},
           }},
          {{
               {4, 3, 1},
               {5, 4, 4},
               {4, 3, 1},
               {3, 2, 1},
               {4, 1, 2},
           },
           {
               {3, 3, 2},
               {1, 1, 5},
               {4, 5, 1},
               {3, 3, 2},
               {3, 1, 5},
           }},
          {{
               {1, 5, 1},
               {1, 3, 2},
               {1, 4, 3},
               {1, 5, 3},
               {4, 5, 2},
           },
           {
               {3, 3, 2},
               {1, 1, 5},
               {3, 3, 1},
               {3, 2, 5},
               {1, 3, 5},
           }},
          {{
               {1, 1, 2},
               {3, 1, 4},
               {2, 1, 5},
               {1, 3, 4},
               {2, 3, 4},
           },
           {
               {3, 3, 2},
               {4, 3, 1},
               {2, 5, 1},
               {2, 3, 2},
               {1, 5, 5},
           }},
      }},

     {43,
      {
          {{
               {2, 4, 4},
               {2, 4, 5},
               {2, 5, 5},
               {1, 4, 2},
               {4, 5, 1},
           },
           {
               {5, 5, 5},
               {5, 2, 2},
               {4, 4, 1},
               {4, 1, 2},
               {2, 2, 4},
           }},
          {{
               {5, 5, 5},
               {4, 4, 1},
               {2, 2, 4},
               {2, 2, 1},
               {1, 1, 2},
           },
           {
               {2, 4, 4},
               {5, 2, 2},
               {2, 4, 5},
               {2, 5, 5},
               {1, 4, 2},
           }},
          {{
               {5, 2, 2},
               {4, 1, 2},
               {5, 3, 4},
               {2, 1, 5},
               {5, 2, 4},
           },
           {
               {5, 5, 5},
               {2, 4, 4},
               {2, 4, 5},
               {2, 5, 5},
               {4, 4, 1},
           }},
          {{
               {2, 4, 4},
               {2, 4, 5},
               {2, 5, 5},
               {1, 4, 2},
               {1, 5, 4},
           },
           {
               {5, 5, 5},
               {5, 2, 2},
               {4, 4, 1},
               {4, 1, 2},
               {4, 5, 1},
           }},
          {{
               {1, 5, 1},
               {2, 4, 2},
               {2, 5, 2},
               {4, 1, 4},
               {5, 1, 5},
           },
           {
               {2, 4, 4},
               {5, 2, 2},
               {3, 4, 5},
               {1, 5, 5},
               {4, 4, 1},
           }},
          {{
               {5, 2, 2},
               {4, 4, 1},
               {4, 1, 2},
               {4, 5, 1},
               {2, 2, 1},
           },
           {
               {5, 5, 5},
               {2, 4, 4},
               {2, 4, 2},
               {2, 5, 3},
               {1, 4, 2},
           }},
      }},

     {44,
      {
          {{
               {5, 1, 1},
               {4, 3, 2},
               {5, 3, 1},
               {5, 3, 4},
               {2, 1, 5},
           },
           {
               {1, 2, 2},
               {5, 5, 3},
               {1, 1, 4},
               {2, 2, 4},
               {2, 2, 2},
           }},
          {{
               {5, 5, 3},
               {1, 1, 4},
               {2, 2, 4},
               {3, 3, 2},
               {2, 2, 1},
           },
           {
               {5, 1, 1},
               {1, 2, 2},
               {4, 3, 2},
               {5, 3, 1},
               {1, 5, 1},
           }},
          {{
               {1, 2, 2},
               {3, 5, 1},
               {3, 4, 3},
               {4, 5, 3},
               {1, 2, 1},
           },
           {
               {5, 1, 1},
               {5, 5, 3},
               {1, 1, 4},
               {4, 3, 2},
               {2, 1, 4},
           }},
          {{
               {1, 3, 4},
               {2, 2, 4},
               {5, 3, 4},
               {1, 1, 5},
               {2, 3, 5},
           },
           {
               {5, 1, 1},
               {1, 2, 2},
               {5, 5, 3},
               {4, 3, 2},
               {2, 2, 2},
           }},
          {{
               {5, 1, 1},
               {1, 3, 3},
               {2, 2, 2},
               {4, 5, 5},
               {5, 4, 4},
           },
           {
               {5, 5, 3},
               {1, 1, 4},
               {4, 3, 2},
               {2, 2, 4},
               {2, 2, 1},
           }},
          {{
               {5, 5, 3},
               {4, 3, 2},
               {2, 2, 1},
               {5, 3, 2},
               {1, 5, 4},
           },
           {
               {5, 1, 2},
               {1, 2, 2},
               {1, 1, 4},
               {2, 2, 4},
               {2, 2, 3},
           }},
      }},

     {45,
      {
          {{
               {5, 4, 4},
               {4, 5, 4},
               {4, 5, 2},
               {2, 3, 2},
               {5, 2, 3},
           },
           {
               {1, 3, 2},
               {1, 2, 3},
               {1, 1, 1},
               {2, 1, 5},
               {2, 1, 1},
           }},
          {{
               {1, 3, 2},
               {1, 2, 3},
               {4, 1, 2},
               {2, 1, 5},
               {2, 2, 1},
           },
           {
               {1, 1, 1},
               {4, 1, 1},
               {4, 5, 2},
               {2, 3, 2},
               {5, 2, 3},
           }},
          {{
               {1, 1, 5},
               {1, 3, 1},
               {2, 1, 1},
               {1, 2, 1},
               {4, 1, 1},
           },
           {
               {1, 1, 1},
               {5, 4, 4},
               {4, 5, 4},
               {1, 2, 3},
               {4, 5, 2},
           }},
          {{
               {5, 4, 4},
               {4, 5, 4},
               {4, 5, 2},
               {4, 1, 2},
               {2, 1, 5},
           },
           {
               {1, 3, 2},
               {1, 2, 3},
               {2, 3, 2},
               {3, 3, 3},
               {3, 4, 3},
           }},
          {{
               {1, 3, 2},
               {1, 2, 3},
               {2, 3, 2},
               {5, 2, 3},
               {2, 3, 4},
           },
           {
               {3, 3, 4},
               {4, 5, 4},
               {3, 3, 3},
               {4, 1, 2},
               {2, 1, 5},
           }},
          {{
               {3, 4, 3},
               {3, 5, 3},
               {3, 1, 3},
               {2, 3, 3},
               {1, 3, 3},
           },
           {
               {1, 3, 2},
               {5, 4, 4},
               {3, 3, 3},
               {1, 2, 3},
               {4, 5, 2},
           }},
      }},

     {46,
      {
          {{
               {5, 1, 4},
               {2, 2, 4},
               {4, 2, 4},
               {5, 1, 2},
               {2, 1, 1},
           },
           {
               {3, 4, 4},
               {3, 2, 3},
               {3, 3, 3},
               {2, 2, 3},
               {2, 3, 2},
           }},
          {{
               {3, 4, 4},
               {5, 3, 5},
               {2, 2, 3},
               {2, 3, 2},
               {3, 2, 4},
           },
           {
               {3, 2, 3},
               {5, 1, 4},
               {3, 3, 2},
               {2, 2, 4},
               {3, 3, 3},
           }},
          {{
               {3, 2, 3},
               {3, 3, 2},
               {3, 5, 3},
               {3, 4, 3},
               {4, 3, 3},
           },
           {
               {3, 4, 4},
               {5, 3, 5},
               {2, 2, 3},
               {5, 1, 4},
               {3, 3, 3},
           }},
          {{
               {3, 2, 3},
               {5, 3, 5},
               {2, 2, 3},
               {2, 3, 2},
               {3, 3, 2},
           },
           {
               {3, 4, 4},
               {5, 1, 4},
               {3, 2, 4},
               {2, 2, 4},
               {4, 4, 4},
           }},
          {{
               {5, 1, 4},
               {3, 2, 4},
               {2, 2, 4},
               {4, 3, 5},
               {4, 3, 2},
           },
           {
               {3, 4, 4},
               {4, 4, 4},
               {5, 3, 2},
               {2, 2, 3},
               {2, 3, 2},
           }},
          {{
               {3, 4, 4},
               {4, 2, 4},
               {5, 4, 4},
               {2, 4, 4},
               {4, 1, 4},
           },
           {
               {3, 2, 3},
               {5, 3, 5},
               {4, 4, 4},
               {5, 1, 4},
               {2, 3, 2},
           }},
      }},

     {47,
      {
          {{
               {4, 2, 5},
               {2, 5, 5},
               {5, 4, 4},
               {2, 2, 5},
               {2, 5, 3},
           },
           {
               {1, 5, 3},
               {4, 1, 1},
               {2, 1, 4},
               {5, 1, 5},
               {1, 1, 1},
           }},
          {{
               {1, 5, 3},
               {4, 1, 4},
               {2, 1, 4},
               {5, 1, 5},
               {1, 3, 4},
           },
           {
               {4, 2, 5},
               {2, 1, 1},
               {1, 1, 1},
               {2, 2, 5},
               {2, 5, 3},
           }},
          {{
               {1, 1, 4},
               {4, 1, 1},
               {1, 1, 5},
               {1, 3, 1},
               {5, 1, 1},
           },
           {
               {4, 2, 5},
               {2, 5, 5},
               {5, 4, 4},
               {1, 1, 1},
               {4, 1, 4},
           }},
          {{
               {2, 5, 5},
               {1, 5, 3},
               {5, 1, 5},
               {2, 2, 5},
               {2, 5, 3},
           },
           {
               {1, 2, 4},
               {5, 4, 4},
               {4, 1, 4},
               {2, 1, 4},
               {4, 4, 4},
           }},
          {{
               {1, 2, 4},
               {2, 1, 4},
               {1, 3, 4},
               {1, 2, 4},
               {5, 4, 5},
           },
           {
               {2, 5, 5},
               {5, 4, 4},
               {1, 5, 3},
               {4, 4, 4},
               {5, 1, 5},
           }},
          {{
               {5, 4, 4},
               {4, 1, 4},
               {2, 4, 4},
               {3, 4, 4},
               {4, 2, 4},
           },
           {
               {4, 2, 5},
               {4, 4, 4},
               {1, 5, 3},
               {2, 1, 4},
               {5, 1, 5},
           }},
      }},

     {48,
      {
          {{
               {2, 3, 3},
               {1, 4, 4},
               {3, 4, 5},
               {4, 5, 1},
               {1, 4, 1},
           },
           {
               {1, 1, 1},
               {5, 4, 4},
               {4, 1, 2},
               {5, 5, 4},
               {2, 1, 5},
           }},
          {{
               {2, 3, 3},
               {1, 4, 4},
               {2, 1, 5},
               {2, 1, 3},
               {3, 1, 4},
           },
           {
               {1, 1, 1},
               {5, 4, 4},
               {4, 1, 2},
               {5, 5, 4},
               {4, 2, 4},
           }},
          {{
               {4, 1, 2},
               {2, 1, 5},
               {4, 2, 4},
               {2, 1, 3},
               {4, 3, 4},
           },
           {
               {1, 1, 1},
               {2, 3, 3},
               {1, 4, 4},
               {5, 4, 4},
               {5, 5, 4},
           }},
          {{
               {1, 1, 1},
               {5, 5, 4},
               {2, 2, 3},
               {3, 3, 5},
               {4, 4, 3},
           },
           {
               {2, 3, 3},
               {1, 4, 4},
               {5, 4, 4},
               {4, 1, 2},
               {2, 1, 5},
           }},
          {{
               {1, 1, 1},
               {4, 2, 4},
               {4, 3, 4},
               {1, 4, 1},
               {2, 1, 2},
           },
           {
               {2, 3, 3},
               {1, 4, 4},
               {5, 4, 4},
               {4, 1, 2},
               {5, 5, 4},
           }},
          {{
               {1, 1, 1},
               {2, 3, 3},
               {1, 4, 4},
               {5, 4, 4},
               {5, 1, 1},
           },
           {
               {4, 1, 2},
               {5, 5, 4},
               {2, 1, 5},
               {4, 2, 4},
               {2, 1, 3},
           }},
          {{
               {5, 4, 4},
               {4, 1, 2},
               {2, 1, 5},
               {4, 2, 4},
               {2, 1, 3},
           },
           {
               {1, 1, 1},
               {2, 3, 3},
               {1, 4, 4},
               {5, 5, 4},
               {3, 4, 5},
           }},
          {{
               {5, 4, 4},
               {4, 1, 2},
               {5, 5, 4},
               {5, 1, 1},
               {5, 4, 3},
           },
           {
               {1, 1, 1},
               {2, 3, 3},
               {1, 4, 4},
               {2, 1, 5},
               {4, 2, 4},
           }},
          {{
               {5, 5, 4},
               {5, 4, 3},
               {4, 5, 1},
               {1, 4, 1},
               {3, 4, 2},
           },
           {
               {1, 1, 1},
               {2, 3, 3},
               {1, 4, 4},
               {5, 4, 4},
               {4, 1, 2},
           }},
      }}};

TEST(Verifiers, OtherData) {
  for (std::size_t card = 1; card <= 48; ++card) {
    if (IsSimple(card)) {
      continue;
    }
    const Verifier& v = verifiers[card - 1];
    const auto iter = other_data.find(card);
    if (iter == other_data.end()) {
      ADD_FAILURE() << "Missing data for " << card;
    } else {
      const std::vector<std::vector<std::vector<Triple>>>& golden =
          iter->second;
      ASSERT_EQ(golden.size(), v.size());
      for (size_t i = 0; i < v.size(); ++i) {
        ASSERT_EQ(golden[i].size(), 2);
        for (const Triple& t : golden[i][0]) {
          EXPECT_TRUE(v[i](t[0], t[1], t[2]))

              << "Card " << card << ", part " << i;
        }
        for (const Triple& t : golden[i][1]) {
          EXPECT_FALSE(v[i](t[0], t[1], t[2]))
              << "Card " << card << ", part " << i;
        }
      }
    }
  }
}
